<!-- spec-flow: хотфикс фичи -->

Шаблон автоматизирует сопровождение фичи после релиза: фиксирует горячие исправления и синхронно обновляет все артефакты **spec-flow** (спеку, план, задачи и отчёт проверки).

**Параметры**
- **FEATURE** — название папки с артефактами фичи. Определяется значением между первыми двумя символами `#` (например, `#billing#` → `billing`).
- **CONTEXT** — суть хотфикса и ожидаемый результат. Это всё, что передаётся после второй `#`; допускается многострочное описание с ссылками на инциденты или PR.

Параметры передаются одной строкой: `#<feature># <контекст>`.

**Общие правила**
- Работай только в каталоге `spec/features/{FEATURE}/`: разрешено редактировать `spec.md`, `plan.md`, `tasks.md`, `verify-report.md` и создавать сводку хотфикса.
- Сохраняй структуру существующих документов: не удаляй разделы, не оставляй пустых заголовков и подсказок из шаблонов.
- Все изменения должны учитывать требования из спецификации и плана, поддерживая консистентность терминов и ссылок.
- Фактическое состояние задач обязательно отражай в `tasks.md`: не допускай рассинхрона между чекбоксами и отчётом.
- В `verify-report.md` добавляй новую запись с датой, фиксируя контекст хотфикса, обновлённые статусы и необходимые действия.

**Логика автоматических обновлений**
- `spec.md` — обнови разделы, на которые влияет хотфикс: уточни пользовательские сценарии, правила или нефункциональные требования, добавь новые Assumptions при появлении открытых вопросов.
- `plan.md` — скорректируй технические решения: источники данных, контракты, архитектурные ограничения и риски, чтобы план отражал текущее устройство фичи.
- `tasks.md` —
  - Добавь новые чекбоксы для работ, требуемых хотфиксом, сгруппируй их в подходящие разделы.
  - Обнови статусы существующих задач (`[ ]`/`[x]`), учитывая фактическое выполнение и результаты хотфикса.
  - Для каждой задачи укажи необходимые проверки: тесты, ручные сценарии, обновление документации.
- `verify-report.md` — дополни журнал новой секцией с датой. Зафиксируй выполненные действия (✅), невыполненные (❌) и частично закрытые (⚠️) задачи, опиши найденные несоответствия и ссылки на подтверждающие артефакты.

**Шаги**
1. Прочитай `spec.md`, `plan.md`, `tasks.md` и текущий `verify-report.md`, чтобы понять состояние фичи.
2. Сформируй перечень изменений, которые должен внести хотфикс, и отрази их в соответствующих документах. Поддерживай единые термины и ссылки на компоненты.
3. Обнови `tasks.md`: добавь или скорректируй задачи, выстави чекбоксы по факту выполнения, дополни требованиями к проверкам.
4. Добавь в `verify-report.md` свежую запись с датой, описанием хотфикса и результатами проверок.
5. Подготовь отдельную сводку хотфикса, чтобы зафиксировать изменения и дать ссылку на затронутые артефакты.

**Шаблон сводки хотфикса**
```md
<!-- SAVE_AS: spec/features/{FEATURE}/hotfix.md -->
# Hotfix — {Краткое название или ID}

**Дата:** YYYY-MM-DD
**Контекст:** {CONTEXT}

## Обновлённые артефакты
- `spec.md`: {что изменилось и зачем}
- `plan.md`: {какие технические решения скорректированы}
- `tasks.md`: {ключевые задачи и их статусы после хотфикса}
- `verify-report.md`: {итоги проверки и последующие действия}

## Проверки и результаты
- ✅ {успешные проверки или тесты}
- ⚠️ {что осталось проверить / запланированные действия}
- ❌ {ошибки, требующие новых задач}

## Дополнительные заметки
{важные решения, ссылки на инциденты, PR или документацию}
```

Пиши строго в Markdown. Цель — автоматически привести в актуальное состояние все артефакты фичи под хотфикс, синхронизировать чек-листы и отчёт проверки и зафиксировать изменения в отдельной сводке.
