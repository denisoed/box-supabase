<!-- SAVE_AS: spec/features/vue-3-tailwind-init/plan.md -->
# План реализации

**План:** нужно добавить полную настройку Vue 3 проекта с Tailwind CSS, Pinia, TypeScript, Prettier, Sass-переменными, i18n и переключением темы.

## Источники данных / схемы
- Настроить `package.json` с зависимостями: `vue`, `@vitejs/plugin-vue`, `vue-tsc`, `typescript`, `pinia`, `vue-router` (если потребуется пример), `tailwindcss`, `postcss`, `autoprefixer`, `@tailwindcss/forms`, `@tailwindcss/typography`, `sass`, `eslint`, `@vue/eslint-config-typescript`, `@vue/eslint-config-prettier`, `prettier`, `lint-staged`, `husky`, `vue-i18n`, `@intlify/unplugin-vue-i18n`.
- Сгенерировать базовую структуру Vite с шаблоном `vue-ts`. Подключить Tailwind согласно официальной инструкции: `tailwind.config.cjs`, `postcss.config.cjs`, настроить пути purge под `.vue`/`.ts` файлы и гарантировать совместимость с TypeScript.
- Определить в `tailwind.config.cjs` набор цветовых токенов, брейкпоинтов, светлой и темной палитр, подключить плагины и включить `darkMode` (`class`), чтобы синхронизировать состояние с композаблом темы. Убедиться, что purge охватывает `src/**/*.{vue,ts}`.
- Добавить `src/assets/main.scss` вместо `main.css`, импортировать туда `@tailwind base;`, `components;`, `utilities;` и SCSS-токены.
- Подготовить `src/styles/tokens.scss` с Sass-переменными для цветов, типографики и spacing, генерирующими CSS-переменные для `:root` и `.dark` (через mixin), чтобы Tailwind и кастомные стили могли использовать единые значения.
- Добавить конфигурации инструментов: `.eslintrc.cjs`, `tsconfig.json` (включая `compilerOptions` для строгой типизации), `tsconfig.node.json` для Vite, `.prettierrc` или `prettier.config.cjs`, `.npmrc` (фиксируем менеджер пакетов) и `.nvmrc`/`package.json#engines` для Node LTS.

## Контракты и интерфейсы
- Определить стандартные npm-скрипты: `dev`, `build`, `preview`, `test:type` (при необходимости `vue-tsc --noEmit`), `lint`, `format`, `prepare` для Husky. Документировать их в README.
- Настроить ESLint + Prettier интеграцию: расширения `plugin:vue/vue3-recommended`, `@vue/eslint-config-typescript/recommended`. Описать формат сообщений об ошибках и правила автопочинки.
- Подготовить шаблон README с инструкциями по установке Node LTS, запуску команд, управлению темами и локализацией, а также решению распространённых проблем (конфликт портов, переустановка зависимостей).
- Зафиксировать соглашения по наименованию дизайн-токенов и процессу добавления новых цветов/шрифтов; описать использование композабла `useColorScheme` и связь с Tailwind `dark` классом.
- Определить требования к локализации: структура `locales/<lang>.json`, ключи в `kebab-case`, настройка fallback-языка, список поддерживаемых локалей и процесс добавления переводов.
- Описать подключение Pinia как централизованного сторедж-слоя: инициализация стора в `src/main.ts`, пример создания `src/stores/counter.ts`, соглашения по модулям.
- Если используется Vue Router, задокументировать базовые маршруты и соглашения по добавлению страниц.

## Архитектура / Компоненты
- Создать файловую структуру `src/` с разделением на `components`, `views`, `stores`, `styles`, `router` (опционально), `types`. Обеспечить импорт глобальных стилей и Tailwind.
- В `src/main.ts` подключить `createApp`, зарегистрировать Pinia, опциональный Router, i18n-плагин и импортировать `main.scss`; при монтировании вызывать инициализацию темы из композабла.
- Добавить пример страницы (`App.vue` + компонент из `components/`), демонстрирующий Tailwind-утилиты и состояние из Pinia.
- Создать композабл `src/composables/useColorScheme.ts`: реактивный стейт, сохранение предпочтения в `localStorage`, подписка на `matchMedia('(prefers-color-scheme: dark)')` и управление классом `dark` на `document.documentElement`.
- Добавить UI-компонент `ThemeToggle.vue`, использующий композабл и демонстрирующий работу переменных (фон, текст, бордеры).
- Настроить i18n: создать `src/plugins/i18n.ts` с конфигурацией `createI18n`, папку `src/locales/` с минимум двумя JSON-файлами (`en.json`, `ru.json`), включить lazy-loading (опционально через `@intlify/unplugin-vue-i18n`) и предусмотреть стор для хранения выбранного языка.
- Настроить Vite конфигурацию (`vite.config.ts`) с поддержкой алиасов (`@` → `src`), плагина Vue и соответствующих типов.
- Добавить Husky hook `pre-commit` с запуском `lint-staged` (ESLint + Prettier) и `vue-tsc` при необходимости. Описать процесс в планах.
- Включить настройку автоматических импортов типов (например, `env.d.ts`) и поддержку `.vue` файлов TypeScript.

## Риски
- Несовместимость версий пакетов (Vue 3, Vite, Tailwind). План: фиксировать версии и протестировать `npm run build` + `npm run dev`.
- Конфликты ESLint и Prettier правил. План: использовать официальные конфигурации `@vue/eslint-config-prettier` и проверить автопочинку.
- Tailwind может увеличить размер бандла, если purge настроен неверно. План: проверить сборку и наличие tree-shaking.
- Sass-переменные и Tailwind-токены могут расходиться. План: написать документацию по обновлению токенов и добавить визуальные снапшоты (Storybook/скриншоты) для проверки тем.
- Переключение темы может конфликтовать с системными настройками или SSR. План: инициализировать тему до монтирования приложения, предусмотреть guard для `document` и покрыть кейсы без `localStorage`.
- Pinia требует строгой типизации стора; при ошибочных типах сборка падает. План: добавить пример стора с типами и запустить `vue-tsc`.
- Отсутствие переводов для новых ключей может приводить к падению i18n. План: включить проверку CI, валидирующую JSON локалей, и добавить fallback-строки.
- Husky/lint-staged могут не запускаться в CI. План: продублировать проверки через отдельный CI-скрипт (lint + build).

## Допущения
- Node.js версии ≥18 доступен локально и на CI; менеджер пакетов — npm.
- Проект не требует подключения к внешнему API на этапе шаблона, поэтому сторы Pinia демонстрируют локальное состояние.
- Команда согласна на структуру директорий и использование Vue Router по умолчанию (при необходимости его можно удалить).
- CI уже настроен для запуска npm-скриптов и установки зависимостей.
- Базовые цветовые токены и значения типографики предоставлены дизайнером либо согласованы заранее.
- Стартовый набор переводов (например, `en` и `ru`) доступен, а остальные языки будут добавляться позже через согласованный процесс.
- Пользователи допускают использование class-based переключателя тем (`dark` на `html`) без SSR-ограничений.
